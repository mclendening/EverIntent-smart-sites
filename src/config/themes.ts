/**
 * @fileoverview Static theme configuration for production deployment.
 * @module config/themes
 * 
 * This file is the PRODUCTION source of truth for themes.
 * Generated by admin "Publish to Production" workflow via sync-theme-to-github edge function.
 * 
 * DO NOT edit manually - use admin theme editor and "Publish to Production".
 * 
 * SSG Compatible: Imported statically, zero runtime database calls.
 * 
 * Theme System Architecture:
 * 1. index.css = SSG baseline (prevents flash on initial load)
 * 2. themes.ts = static config (source of truth, committed via GitHub publish)
 * 3. applyThemeToRoot() = client-side override for route-based theme switching
 */

// ============================================
// TYPE DEFINITIONS
// ============================================

/**
 * Configuration for logo text elements ("Ever" and "Intent").
 * Controls typography, colors, and gradients for each word.
 */
export interface LogoElementConfig {
  /** Font size in pixels */
  size: number;
  /** Font weight (400-900) */
  weight: number;
  /** Solid color when gradient is disabled (hex format) */
  solidColor: string;
  /** Whether to use gradient instead of solid color */
  useGradient: boolean;
  /** Gradient start color (hex format) */
  gradientFrom: string;
  /** Gradient end color (hex format) */
  gradientTo: string;
  /** Gradient angle in degrees */
  gradientAngle: number;
  /** Left margin in pixels */
  marginLeft: number;
  /** Right margin in pixels */
  marginRight: number;
  /** Vertical offset for baseline alignment */
  verticalOffset?: number;
}

/**
 * Configuration for the logo streak/accent line.
 * Creates a tapered horizontal line under the logo text.
 */
export interface StreakElementConfig {
  /** Total length in pixels */
  length: number;
  /** Left side thickness in pixels */
  leftThick: number;
  /** Right side thickness in pixels (creates taper) */
  rightThick: number;
  /** Solid color when gradient is disabled (hex format) */
  solidColor: string;
  /** Whether to use gradient instead of solid color */
  useGradient: boolean;
  /** Gradient start color (hex format) */
  gradientFrom: string;
  /** Gradient end color (hex format) */
  gradientTo: string;
  /** Gradient angle in degrees */
  gradientAngle: number;
  /** Left margin in pixels */
  marginLeft: number;
  /** Right margin in pixels */
  marginRight: number;
}

/**
 * Configuration for the logo tagline text.
 * Displays brand tagline below the main logo.
 */
export interface TaglineElementConfig {
  /** Font size in pixels */
  size: number;
  /** Font weight (400-900) */
  weight: number;
  /** Solid color when gradient is disabled (hex format) */
  solidColor: string;
  /** Whether to use gradient instead of solid color */
  useGradient: boolean;
  /** Gradient start color (hex format) */
  gradientFrom: string;
  /** Gradient end color (hex format) */
  gradientTo: string;
  /** Gradient angle in degrees */
  gradientAngle: number;
  /** Left margin in pixels */
  marginLeft: number;
  /** Right margin in pixels */
  marginRight: number;
  /** Top margin from logo in pixels */
  marginTop: number;
}

/**
 * Complete theme configuration for the site.
 * Defines colors, gradients, and logo styling for a theme variant.
 */
export interface ThemeConfig {
  /** Unique theme identifier */
  id: string;
  /** Human-readable theme name */
  name: string;
  /** Base hue for theme color calculations (0-360) */
  baseHue: number;
  /** Accent color configuration for interactive elements */
  accentConfig: {
    /** Primary accent color (HSL format) */
    accent: string;
    /** Hover state accent color (HSL format) */
    accentHover: string;
    /** Glow effect accent color (HSL format) */
    accentGlow: string;
    /** Text color on accent backgrounds (HSL format) */
    accentForeground: string;
    /** Hue component (0-360) */
    h: number;
    /** Saturation component (0-100) */
    s: number;
    /** Lightness component (0-100) */
    l: number;
  };
  /** Static color palette for UI elements */
  staticColors: {
    background: string;
    foreground: string;
    card: string;
    cardForeground: string;
    popover: string;
    popoverForeground: string;
    primary: string;
    primaryLight: string;
    primaryForeground: string;
    secondary: string;
    secondaryForeground: string;
    muted: string;
    mutedForeground: string;
    border: string;
    input: string;
    ring: string;
  };
  /** Gradient definitions for hero, CTA, and text effects */
  gradientConfigs: {
    /** Hero section background gradient */
    hero: string;
    /** CTA button gradient */
    cta: string;
    /** Gradient text effect */
    text: string;
  };
  /** Optional linked logo version ID from database */
  logoVersionId?: string;
  /** Optional embedded logo configuration */
  logoConfig?: {
    /** Tagline text (e.g., "Web Design & AI Automation") */
    taglineText: string;
    /** "Ever" text configuration */
    everConfig: LogoElementConfig;
    /** "Intent" text configuration */
    intentConfig: LogoElementConfig;
    /** Accent streak configuration */
    streakConfig: StreakElementConfig;
    /** Tagline text configuration */
    taglineConfig: TaglineElementConfig;
  };
}

/**
 * Maps a route path to a specific theme.
 * Enables per-page theme customization.
 */
export interface RouteThemeMapping {
  /** Route path (e.g., '/' or '/pricing') */
  route: string;
  /** Theme ID to apply for this route */
  themeId: string;
}

// ============================================
// ACTIVE PRODUCTION THEME (Indigo Night)
// ============================================

/**
 * Currently active production theme.
 * Applied as default when no route-specific mapping exists.
 */
export const activeTheme: ThemeConfig = {
  id: 'indigo-night',
  name: 'Indigo Night',
  baseHue: 240,
  accentConfig: {
    accent: '240 70% 60%',
    accentHover: '32 95% 44%',
    accentGlow: '240 70% 60%',
    accentForeground: '222 47% 11%',
    h: 240,
    s: 70,
    l: 60,
  },
  staticColors: {
    background: '222 47% 7%',
    foreground: '60 9% 98%',
    card: '222 47% 10%',
    cardForeground: '60 9% 98%',
    popover: '222 47% 10%',
    popoverForeground: '60 9% 98%',
    primary: '215 25% 27%',
    primaryLight: '215 20% 40%',
    primaryForeground: '0 0% 100%',
    secondary: '222 47% 12%',
    secondaryForeground: '60 9% 98%',
    muted: '222 47% 15%',
    mutedForeground: '215 16% 65%',
    border: '215 25% 20%',
    input: '215 25% 20%',
    ring: '247 92% 50%',
  },
  gradientConfigs: {
    hero: 'linear-gradient(135deg, hsl(222 47% 11%) 0%, hsl(240 30% 18%) 50%, hsl(222 47% 11%) 100%)',
    cta: 'linear-gradient(135deg, hsl(240 70% 60%) 0%, hsl(250 70% 50%) 100%)',
    text: 'linear-gradient(135deg, hsl(240 70% 60%) 0%, hsl(250 70% 70%) 50%, hsl(240 70% 60%) 100%)',
  },
  logoVersionId: 'f427aa31-0016-408e-98d4-86a7573b1b15',
  logoConfig: {
    taglineText: 'Web Design & AI Automation',
    everConfig: {
        "size": 72,
        "weight": 700,
        "gradientTo": "#A855F7",
        "marginLeft": 0,
        "solidColor": "#FFFFFF",
        "marginRight": 3,
        "useGradient": false,
        "gradientFrom": "#FFFFFF",
        "gradientAngle": 135,
        "verticalOffset": -1
    },
    intentConfig: {
        "size": 72,
        "weight": 700,
        "gradientTo": "#FFFFFF",
        "marginLeft": 0,
        "solidColor": "#A855F7",
        "marginRight": 0,
        "useGradient": false,
        "gradientFrom": "#A855F7",
        "gradientAngle": 135,
        "verticalOffset": 1
    },
    streakConfig: {
        "length": 384,
        "leftThick": 4,
        "gradientTo": "#7878dd",
        "marginLeft": 0,
        "rightThick": 1,
        "solidColor": "#A855F7",
        "marginRight": 0,
        "useGradient": true,
        "gradientFrom": "#A855F7",
        "gradientAngle": 90
    },
    taglineConfig: {
        "size": 28,
        "weight": 400,
        "marginTop": 5,
        "gradientTo": "#A855F7",
        "marginLeft": 0,
        "solidColor": "#FFFFFF",
        "marginRight": 0,
        "useGradient": false,
        "gradientFrom": "#FFFFFF",
        "gradientAngle": 135
    },
  },
};

// ============================================
// ROUTE-TO-THEME MAPPINGS
// ============================================

/**
 * Route-specific theme overrides.
 * Falls back to activeTheme if no mapping exists.
 */
export const routeThemeMappings: RouteThemeMapping[] = [
  { route: '/', themeId: '38aafcee-1959-4968-b74b-6c2d53815323' },
];

// ============================================
// ALL PUBLISHED THEMES
// ============================================

/**
 * All available published themes indexed by ID.
 * Used for route-based theme lookups.
 */
export const publishedThemes: Record<string, ThemeConfig> = {
  'indigo-night': activeTheme,
};

// ============================================
// HELPER FUNCTIONS
// ============================================

/**
 * Gets the appropriate theme for a given route path.
 * Checks route mappings first, falls back to activeTheme.
 * 
 * @param pathname - Current route path (e.g., '/pricing')
 * @returns ThemeConfig for the route
 * 
 * @example
 * const theme = getThemeForRoute('/pricing');
 * applyThemeToRoot(theme);
 */
export function getThemeForRoute(pathname: string): ThemeConfig {
  const topLevel = '/' + (pathname.split('/')[1] || '');
  const mapping = routeThemeMappings.find(m => m.route === topLevel);
  if (mapping && publishedThemes[mapping.themeId]) {
    return publishedThemes[mapping.themeId];
  }
  return activeTheme;
}

/**
 * Applies theme CSS variables to the document root.
 * Called on route change for dynamic theme switching.
 * 
 * Sets CSS custom properties for:
 * - Static colors (background, foreground, card, etc.)
 * - Accent colors (accent, accent-hover, accent-glow, accent-foreground)
 * - Gradient definitions (hero, cta, text)
 * 
 * @param theme - ThemeConfig to apply
 * 
 * @example
 * const theme = getThemeForRoute(location.pathname);
 * applyThemeToRoot(theme);
 */
export function applyThemeToRoot(theme: ThemeConfig): void {
  const root = document.documentElement;
  Object.entries(theme.staticColors).forEach(([key, value]) => {
    const cssVar = key.replace(/([A-Z])/g, '-$1').toLowerCase();
    root.style.setProperty(`--${cssVar}`, value);
  });
  root.style.setProperty('--accent', theme.accentConfig.accent);
  root.style.setProperty('--accent-hover', theme.accentConfig.accentHover);
  root.style.setProperty('--accent-glow', theme.accentConfig.accentGlow);
  root.style.setProperty('--accent-foreground', theme.accentConfig.accentForeground);
  root.style.setProperty('--gradient-hero', theme.gradientConfigs.hero);
  root.style.setProperty('--gradient-cta', theme.gradientConfigs.cta);
  root.style.setProperty('--gradient-text', theme.gradientConfigs.text);
  
  // Apply GHL chat widget theming (derived from accent if not specified)
  const accent = theme.accentConfig.accent;
  root.style.setProperty('--ghl-textarea-bg', theme.staticColors.background);
  root.style.setProperty('--ghl-textarea-text', theme.staticColors.foreground);
  root.style.setProperty('--ghl-textarea-border', theme.staticColors.border);
  root.style.setProperty('--ghl-textarea-focus-border', accent);
  root.style.setProperty('--ghl-textarea-focus-glow', accent);
  root.style.setProperty('--ghl-send-button-bg', accent);
  root.style.setProperty('--ghl-send-button-border', '0 0% 100%');
  root.style.setProperty('--ghl-send-button-icon', '0 0% 100%');
  root.style.setProperty('--ghl-selection-bg', accent);
}
